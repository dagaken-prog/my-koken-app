# **成年後見業務支援システム 仕様書**

最終更新日: 2026/01/18  
バージョン: Supabase版 v1.1 (モジュール分割・UI改善版)

## **1\. システム概要**

本システムは、成年後見人が行う日常業務（身上保護・財産管理）を効率化し、クラウド上で安全にデータを管理するためのWebアプリケーションです。

### **1.1 システム構成**

| 項目 | 採用技術・サービス | 備考 |
| :---- | :---- | :---- |
| **フロントエンド** | Streamlit (Python) | UI構築、画面遷移、データ表示 |
| **バックエンド** | Python 3.x | ロジック処理、データ加工 (モジュール分割済み) |
| **データベース** | Supabase (PostgreSQL) | リレーショナルデータベースによるデータ管理 |
| **ホスティング** | Streamlit Community Cloud | アプリケーションの公開・実行環境 |
| **ソースコード管理** | GitHub | バージョン管理、デプロイ連携 |
| **帳票出力** | openpyxl | Excelテンプレートへのデータ埋め込み |

### **1.2 主な特徴**

* **マルチデバイス対応:** PC、スマートフォン、タブレットのブラウザから利用可能。  
* **レスポンシブデザイン:** スマホ利用時はボタンや入力フォームが最適化される。  
* **堅牢なデータ管理:** データベース(SQL)による型定義、一意性制約、高速な検索。  
* **マスタ管理:** 活動種別や関係種別などをGUI上でカスタマイズ可能。

## **2\. 機能一覧**

### **2.1 利用者情報・活動記録**

* **受任中利用者一覧:** 現在「受任中」の利用者のみをフィルタリング表示。  
* **基本情報表示:** 氏名、年齢（自動計算）、類型、事件番号、キーパーソン情報の表示。  
* **活動記録登録:** 日付、活動種別、時間、場所、費用、重要フラグ、内容の登録。  
* **履歴管理:** 時系列での履歴表示（アコーディオン形式）。編集・削除機能。

### **2.2 関係者・連絡先**

* **関係者管理:** 親族、ケアマネ、医療機関等の連絡先登録。  
* **ワンタップ発信:** スマホ表示時に電話番号タップで発信、メール起動。  
* **キーパーソン設定:** 重要人物をフラグ管理し、基本情報画面に表示。

### **2.3 財産管理**

* **財産登録:** 預貯金、不動産、保険、負債などの財産情報登録。  
* **詳細管理:** 口座番号、保管場所、評価額の管理。

### **2.4 利用者情報登録**

* **新規登録:** 新しい被後見人の登録。  
* **情報編集:** 住所変更、類型変更、終了ステータスへの変更など、全項目の編集。

### **2.5 帳票作成**

* **Excel出力:** ユーザーが用意したExcelテンプレート（{{氏名}}等のプレースホルダー付き）へのデータ埋め込みとダウンロード。

### **2.6 データ管理・移行**

* **CSVエクスポート:** 全テーブル（利用者、活動、財産、関係者、システム）のデータ出力。  
* **CSVインポート:** 既存データの取り込み（Upsert処理による重複防止）。  
* **テンプレートDL:** インポート用の空CSVのダウンロード。

### **2.7 初期設定**

* **初期設定:** 活動種別、財産種別、関係種別、後見類型の選択肢を追加・削除。  
  * ※使用中の選択肢は削除できない安全機能付き。  
* **システム利用者登録:** 報告書作成者（後見人自身）の情報の登録。

### **2.8 ドキュメント**

* **操作マニュアル:** ユーザー向けの操作手順書 (`操作マニュアル.md`) を整備。

## **3\. データベース設計 (Supabase)**

### **3.1 persons (利用者基本情報)**

| カラム名 | 論理名 | 型 | 備考 |
| :---- | :---- | :---- | :---- |
| person\_id | ID | bigint | PK, 自動採番 |
| case\_number | ケース番号 | text | 管理用No. |
| basic\_case\_number | 基本事件番号 | text | 家裁事件番号 |
| name | 氏名 | text |  |
| kana | シメイ | text |  |
| dob | 生年月日 | date |  |
| address | 住所 | text |  |
| residence | 居所 | text | 施設名等 |
| guardianship\_type | 類型 | text | 後見/保佐/補助等 |
| disability\_type | 障害類型 | text |  |
| petitioner | 申立人 | text |  |
| judgment\_date | 審判確定日 | date |  |
| court | 管轄家裁 | text |  |
| report\_month | 家裁報告月 | text |  |
| status | 現在の状態 | text | 受任中/終了 |

### **3.2 activities (活動記録)**

| カラム名 | 論理名 | 型 | 備考 |
| :---- | :---- | :---- | :---- |
| activity\_id | ID | bigint | PK, 自動採番 |
| person\_id | 利用者ID | bigint | FK (persons) |
| activity\_date | 活動日 | date |  |
| activity\_type | 活動種別 | text | マスタ参照 |
| location | 場所 | text |  |
| duration | 所要時間 | int | 分単位 |
| expense | 費用 | int | 円単位 |
| is\_important | 重要フラグ | boolean |  |
| note | 内容 | text |  |
| created\_at | 作成日時 | timestamptz | 自動設定 |

### **3.3 related\_parties (関係者)**

| カラム名 | 論理名 | 型 | 備考 |
| :---- | :---- | :---- | :---- |
| related\_id | ID | bigint | PK, 自動採番 |
| person\_id | 利用者ID | bigint | FK (persons) |
| relationship | 関係種別 | text | マスタ参照 |
| name | 氏名 | text |  |
| organization | 所属 | text |  |
| phone | 電話番号 | text |  |
| email | e-mail | text |  |
| postal\_code | 〒 | text |  |
| address | 住所 | text |  |
| is\_keyperson | キーパーソン | boolean |  |
| note | 連携メモ | text |  |

### **3.4 assets (財産)**

| カラム名 | 論理名 | 型 | 備考 |
| :---- | :---- | :---- | :---- |
| asset\_id | ID | bigint | PK, 自動採番 |
| person\_id | 利用者ID | bigint | FK (persons) |
| asset\_type | 財産種別 | text | マスタ参照 |
| name | 名称 | text | 金融機関名等 |
| detail | 詳細 | text | 支店名等 |
| account\_number | 口座番号 | text | 記号番号等 |
| value | 評価額 | bigint | 残高 |
| storage\_location | 保管場所 | text |  |
| note | 備考 | text |  |

### **3.5 app\_system\_user (システム利用者)**

| カラム名 | 論理名 | 型 | 備考 |
| :---- | :---- | :---- | :---- |
| id | ID | bigint | PK |
| name | 氏名 | text |  |
| ... | (他住所等) | text |  |

### **3.6 master\_options (選択肢マスタ)**

| カラム名 | 論理名 | 型 | 備考 |
| :---- | :---- | :---- | :---- |
| id | ID | bigint | PK |
| category | カテゴリ | text | activity, asset等 |
| name | 名称 | text | 表示名 |
| sort\_order | 順序 | int | 表示順 |

